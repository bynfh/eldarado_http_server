# eldarado_http_server
Test task from eldarado

# Задание

- Написать Web API на Python с одним эндпоинтом, который принимает sku в качестве параметра и возвращает список всех товаров, рекомендованных для этого sku. Должна быть возможность указать опциональный параметр минимального порога близости для рекомендаций. 
- Продумать стратегию масштабирования сервиса при увеличении нагрузки, а также дать примерную оценку потребления ресурсов в случае, если размер данных по рекомендациям начнет расти.
 

# Ограничения на решение

- Задача должна быть решена без использования сторонних библиотек и сервисов (вроде баз данных). Допустимо использование только стандартной библиотеки Python.
- Модуль sqlite3 использовать нельзя.
- Максимальное время ответа API на запрос — 500 мс.
- При выборе между меньшей скоростью ответа на запрос и меньшим потреблением оперативной памяти предпочтение отдавать меньшей скорости ответа.
 

# Критерии оценки

- Следование лучшим практикам при организации проекта.
- Кодстайл.
- Общее качество кода.
- Время ответа API на запрос.
- Потребление оперативной памяти.

# Алгоритм решения задачи
- Так как все задачи решены до нас, попытался найти готовое решение в интернете. (Не нашел)
- Начал думать как обработать большой CSV файл. Было несколько идей:
    1. Отсортировать CSV. Бинарным поиском искать нужный элемент в CSV.
    2. Отсортировать CSV и разбить на несколько меньших CSV. В имени CSV указать первое имя sku и последнее. По этому критерию искать.
    3. Загрузить в память в виде словаря, где ключи - sku, а значение - строка из всех рекоммендаций для этого sku с разделителем ';'
    
 :negative_squared_cross_mark: Первый метод не получился, так как для бинарного поиска нужно загрузить в память весь список sku. 
 
 :negative_squared_cross_mark: Второй метод не стал пробовать. 
 
 :white_check_mark: Выбор пал на третий метод. Загрузка идет 60 секунд примерно. В оперативной памяти занимается место по сравнению с другими вариантами меньше.
 
 - Хотел спросить в каком формате отдавать данные, потому что в ТЗ указанно:"Списком". Вообще изначально хотел сделать только json, но еще добавил html
 
 ## Что не получилось
 
- Найти решение, когда при запросе мы ищем сразу в CSV файле. При этом время ответа остается в рамках поставленной задачи.
Думаю, что это связано с тем, что у меня всегда было решение для таких задач - это работа с БД.
- В ТЗ указанно, что кол-во рекоммендаций может быть столько же сколько sku. Тогда вариант решения не подойдет.

# Инструкция по запуску API
- csv файл должен находиться в корне проекта или вам нужно явно указать путь к csv файлу в config.py или в командной строке при запуске. Default =='./sorted_recommends.csv'
- в корне с проектом можно выполнить: python Eldarado_api_main.py

Запуск будет с параметрами указанными в config.py. Чтобы запустить программу с пользовательскими параметрами, необходимо изменить конфигурационный файл или передать аргументы в командной строке при запуске. Пример:

python Eldarado_api_main.py --max_rows_csv 100 --port 9000

- Стандартные параметры при запуске

HTML = 'True'

DEBUG = 'False'

HOST = '127.0.0.1'

PORT = 8080

PATH_TO_CSV = './sorted_recommends.csv'

MAX_ROWS_FROM_CSV = float("inf")

# Версия python 
python3.8

